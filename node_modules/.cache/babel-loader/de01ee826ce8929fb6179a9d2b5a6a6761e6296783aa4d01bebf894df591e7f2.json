{"ast":null,"code":"var _jsxFileName = \"/home/renan/Desktop/KENZIE/M3/SPRINT 5/ENTREGAS/VERCEL/renangiaretta./kenzieburguer/src/contexts/AuthContext.tsx\",\n  _s = $RefreshSig$();\nimport React, { createContext, useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { toast } from 'react-toastify';\nimport { api } from '../services/api';\nimport 'react-toastify/dist/ReactToastify.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext({});\nexport const AuthProvider = _ref => {\n  _s();\n  let {\n    children\n  } = _ref;\n  const navigate = useNavigate();\n  const [loadUser, setLoadUser] = useState(false);\n  useEffect(() => {\n    async function verifyAuthentication() {\n      const token = localStorage.getItem('TOKEN');\n      api.defaults.headers.common.authorization = `Bearer ${token}`;\n      try {\n        const response = await api.get('/products');\n        setLoadUser(true);\n      } catch (error) {\n        console.error(error);\n        if (window.location.href === 'http://localhost:3000/dashboard') navigate('/login');\n      }\n    }\n    verifyAuthentication();\n  }, [navigate, loadUser]);\n  async function login(data) {\n    try {\n      const response = await api.post('/login', data);\n      const token = response.data.accessToken;\n      localStorage.setItem('TOKEN', token);\n      setLoadUser(true);\n      toast('Login realizado com sucesso');\n      navigate('/dashboard');\n    } catch (error) {\n      console.error(error);\n      toast('Não foi possível realizar o login');\n    } finally {}\n  }\n  const registerUser = async data => {\n    try {\n      const response = await api.post('/users', data);\n      toast('Cadastro realizado com sucesso!');\n      navigate('/login');\n    } catch (error) {\n      toast('Não foi possível realizar o cadastro. Verifique os dados e tente novamente.');\n      console.error(error);\n    } finally {}\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      login,\n      registerUser,\n      children,\n      loadUser\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 9\n  }, this);\n};\n_s(AuthProvider, \"byhisyjnB4esz6fvIv6qJXN4cs8=\", false, function () {\n  return [useNavigate];\n});\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useEffect","useState","useNavigate","toast","api","AuthContext","AuthProvider","children","navigate","loadUser","setLoadUser","verifyAuthentication","token","localStorage","getItem","defaults","headers","common","authorization","response","get","error","console","window","location","href","login","data","post","accessToken","setItem","registerUser"],"sources":["/home/renan/Desktop/KENZIE/M3/SPRINT 5/ENTREGAS/VERCEL/renangiaretta./kenzieburguer/src/contexts/AuthContext.tsx"],"sourcesContent":["import React, { createContext, useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { toast } from 'react-toastify';\nimport { api } from '../services/api';\nimport 'react-toastify/dist/ReactToastify.css';\nexport interface iAuthContextProps{\n    children    : React.ReactNode\n    loadUser    : boolean\n    login       : (data: any) => Promise<void>;\n    registerUser: (data: any) => Promise<void>;\n}\n\n\nexport interface iAuthContextType {\n    login       : ( ) => Promise<void>,\n    registerUser: ( ) => Promise<void>;\n}\n\n\nexport const AuthContext = createContext({} as iAuthContextProps)\n\n\nexport const AuthProvider = ({ children }: iAuthContextProps) => {\n    const navigate = useNavigate()\n    const [ loadUser, setLoadUser ] = useState(false)\n    \n    useEffect (() => {\n        async function verifyAuthentication (  ) {\n            const token                                     = localStorage.getItem('TOKEN')\n                  api.defaults.headers.common.authorization = `Bearer ${token}`\n            try {\n                const response = await api.get('/products')\n                    setLoadUser(true)\n                } catch (error) {\n                    console.error(error)\n                    if(window.location.href === 'http://localhost:3000/dashboard')\n                    navigate('/login')\n                }\n            }\n            verifyAuthentication()\n    },[navigate, loadUser])\n\n\n    async function login ( data: any ) {\n        try {\n            const response = await api.post('/login', data)\n            const token = response.data.accessToken\n            localStorage.setItem('TOKEN', token)\n            setLoadUser(true)\n            toast('Login realizado com sucesso');\n            navigate('/dashboard')\n        } catch (error) {\n            console.error(error)\n            toast('Não foi possível realizar o login')\n        }finally{\n        }\n    }\n\n    const registerUser = async (data: any) => {\n        try {\n            const response = await api.post('/users', data)\n            toast('Cadastro realizado com sucesso!')\n            navigate('/login')\n        } catch (error) {\n            toast('Não foi possível realizar o cadastro. Verifique os dados e tente novamente.')\n            console.error(error)\n        }finally {\n        }\n    }\n    \n    return(\n        <AuthContext.Provider value = {{ login, registerUser, children, loadUser }}>\n\n            {children}\n\n        </AuthContext.Provider>\n    )\n}"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,aAAa,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AACjE,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,KAAK,QAAQ,gBAAgB;AACtC,SAASC,GAAG,QAAQ,iBAAiB;AACrC,OAAO,uCAAuC;AAAC;AAe/C,OAAO,MAAMC,WAAW,gBAAGN,aAAa,CAAC,CAAC,CAAC,CAAsB;AAGjE,OAAO,MAAMO,YAAY,GAAG,QAAqC;EAAA;EAAA,IAApC;IAAEC;EAA4B,CAAC;EACxD,MAAMC,QAAQ,GAAGN,WAAW,EAAE;EAC9B,MAAM,CAAEO,QAAQ,EAAEC,WAAW,CAAE,GAAGT,QAAQ,CAAC,KAAK,CAAC;EAEjDD,SAAS,CAAE,MAAM;IACb,eAAeW,oBAAoB,GAAM;MACrC,MAAMC,KAAK,GAAuCC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;MACzEV,GAAG,CAACW,QAAQ,CAACC,OAAO,CAACC,MAAM,CAACC,aAAa,GAAI,UAASN,KAAM,EAAC;MACnE,IAAI;QACA,MAAMO,QAAQ,GAAG,MAAMf,GAAG,CAACgB,GAAG,CAAC,WAAW,CAAC;QACvCV,WAAW,CAAC,IAAI,CAAC;MACrB,CAAC,CAAC,OAAOW,KAAK,EAAE;QACZC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;QACpB,IAAGE,MAAM,CAACC,QAAQ,CAACC,IAAI,KAAK,iCAAiC,EAC7DjB,QAAQ,CAAC,QAAQ,CAAC;MACtB;IACJ;IACAG,oBAAoB,EAAE;EAC9B,CAAC,EAAC,CAACH,QAAQ,EAAEC,QAAQ,CAAC,CAAC;EAGvB,eAAeiB,KAAK,CAAGC,IAAS,EAAG;IAC/B,IAAI;MACA,MAAMR,QAAQ,GAAG,MAAMf,GAAG,CAACwB,IAAI,CAAC,QAAQ,EAAED,IAAI,CAAC;MAC/C,MAAMf,KAAK,GAAGO,QAAQ,CAACQ,IAAI,CAACE,WAAW;MACvChB,YAAY,CAACiB,OAAO,CAAC,OAAO,EAAElB,KAAK,CAAC;MACpCF,WAAW,CAAC,IAAI,CAAC;MACjBP,KAAK,CAAC,6BAA6B,CAAC;MACpCK,QAAQ,CAAC,YAAY,CAAC;IAC1B,CAAC,CAAC,OAAOa,KAAK,EAAE;MACZC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;MACpBlB,KAAK,CAAC,mCAAmC,CAAC;IAC9C,CAAC,SAAO,CACR;EACJ;EAEA,MAAM4B,YAAY,GAAG,MAAOJ,IAAS,IAAK;IACtC,IAAI;MACA,MAAMR,QAAQ,GAAG,MAAMf,GAAG,CAACwB,IAAI,CAAC,QAAQ,EAAED,IAAI,CAAC;MAC/CxB,KAAK,CAAC,iCAAiC,CAAC;MACxCK,QAAQ,CAAC,QAAQ,CAAC;IACtB,CAAC,CAAC,OAAOa,KAAK,EAAE;MACZlB,KAAK,CAAC,6EAA6E,CAAC;MACpFmB,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;IACxB,CAAC,SAAQ,CACT;EACJ,CAAC;EAED,oBACI,QAAC,WAAW,CAAC,QAAQ;IAAC,KAAK,EAAI;MAAEK,KAAK;MAAEK,YAAY;MAAExB,QAAQ;MAAEE;IAAS,CAAE;IAAA,UAEtEF;EAAQ;IAAA;IAAA;IAAA;EAAA,QAEU;AAE/B,CAAC;AAAA,GAvDYD,YAAY;EAAA,QACJJ,WAAW;AAAA;AAAA,KADnBI,YAAY;AAAA;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}